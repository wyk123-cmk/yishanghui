(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/activityCenter/tz-immediatelyget"],{"40da":function(t,e,o){"use strict";var n=o("9cd82"),u=o.n(n);u.a},4492:function(t,e,o){},5498:function(t,e,o){"use strict";(function(t){o("b397");n(o("66fd"));var e=n(o("e4b8"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},"9cd82":function(t,e,o){},b185:function(t,e,o){"use strict";o.r(e);var n=o("e5e6"),u=o.n(n);for(var i in n)"default"!==i&&function(t){o.d(e,t,(function(){return n[t]}))}(i);e["default"]=u.a},de55:function(t,e,o){"use strict";var n=o("4492"),u=o.n(n);u.a},e4b8:function(t,e,o){"use strict";o.r(e);var n=o("f8b0"),u=o("b185");for(var i in u)"default"!==i&&function(t){o.d(e,t,(function(){return u[t]}))}(i);o("de55"),o("40da");var s,r=o("f0c5"),c=Object(r["a"])(u["default"],n["b"],n["c"],!1,null,"7bca1c0a",null,!1,n["a"],s);e["default"]=c.exports},e5e6:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o={data:function(){return{fromCode:"",userSource:"",btntext:"立即领取",couponlist:[],isInit:!1}},onLoad:function(e){void 0!=e.fromCode&&(this.fromCode=e.fromCode),void 0!=e.userSource&&(this.userSource=e.userSource),""!=t.getStorageSync("token")&&void 0!=t.getStorageSync("token")&&null!=t.getStorageSync("token")&&(this.isInit=!0,this.getCouponList())},methods:{immediatelyget:function(){console.log(t.getStorageSync("token")),""==t.getStorageSync("token")||void 0==t.getStorageSync("token")||null==t.getStorageSync("token")?this.authorize_mp_wx():(this.isInit||this.getCouponList(),this.getCoupon())},getCouponList:function(){var t=this;t.$util.networkRequest({url:"/Coupon/GetList",data:{userType:"indi"},success:function(e){if(null==e)return t.$util.showToast("暂无可领取的优惠券"),!1;t.couponlist=e.list;for(var o=e.list,n=[],u=0;u<o.length;u++){var i=o[u];(""==i.isget||null==i.isget||i.isget.indexOf("_")>-1)&&n.push(i)}n.length==o.length&&(t.btntext="已领取")}})},getCoupon:function(){var t=this;t.$util.networkRequest({url:"/Coupon/GetList",data:{userType:"indi"},success:function(e){if(null==e)return t.$util.showToast("暂无可领取的优惠券"),!1;t.couponlist=e.list;for(var o=e.list,n=0;n<o.length;n++){var u=o[n];"0"==u.isget&&t.postCoupon(u.id,u.isget,n)}}})},postCoupon:function(e,o,n){if("1"==o)return!1;var u=this;u.$util.networkRequest({url:"/Coupon/PostVoucherCoupon",method:"POST",data:{userType:"indi",couponId:e},success:function(e){""!==e&&n==u.couponlist.length-1&&(u.$util.showToast("领取成功"),t.reLaunch({url:"/pages/index/index?types=tz"}))}})},isToken:function(t){var e=this;window.location.href="/pages/logs/logs?userSource="+e.userSource+"&fromCode="+e.fromCode+"&type="+t},authorize_mp_wx:function(){var e=this;wx.getSetting({success:function(o){if(1==o.authSetting["scope.userInfo"]&&(console.log("已授权"),e.$util._mp_wx_login("logs","tz",(function(e){1==e.status&&t.reLaunch({url:"/pages/index/index?types=tz"})}))),0==o.authSetting["scope.userInfo"]||void 0==o.authSetting["scope.userInfo"]){console.log("未授权"),e.$util.isGoLogin=!1;t.navigateTo({url:"/pages/logs/logs?state=false&mptype=tz&userSource="+e.userSource+"&fromCode="+e.fromCode})}}})}}};e.default=o}).call(this,o("543d")["default"])},f8b0:function(t,e,o){"use strict";var n,u=function(){var t=this,e=t.$createElement;t._self._c},i=[];o.d(e,"b",(function(){return u})),o.d(e,"c",(function(){return i})),o.d(e,"a",(function(){return n}))}},[["5498","common/runtime","common/vendor"]]]);